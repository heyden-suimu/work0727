webpackJsonp([11,12],{2:function(e,t,r){e.exports={default:r(6),__esModule:!0}},6:function(e,t,r){r(8),e.exports=r(1).Object.assign},7:function(e,t,r){"use strict";var a=r(16),s=r(23),n=r(21),i=r(24),o=r(26),l=Object.assign;e.exports=!l||r(15)(function(){var e={},t={},r=Symbol(),a="abcdefghijklmnopqrst";return e[r]=7,a.split("").forEach(function(e){t[e]=e}),7!=l({},e)[r]||Object.keys(l({},t)).join("")!=a})?function(e,t){for(var r=i(e),l=arguments.length,c=1,u=s.f,d=n.f;l>c;)for(var f,h=o(arguments[c++]),p=u?a(h).concat(u(h)):a(h),g=p.length,v=0;g>v;)d.call(h,f=p[v++])&&(r[f]=h[f]);return r}:l},8:function(e,t,r){var a=r(14);a(a.S+a.F,"Object",{assign:r(7)})},9:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var s=r(2),n=a(s);t.default=n.default||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}},117:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=r(25),n=a(s),i=r(13),o=a(i),l=r(12),c=a(l),u=r(9),d=a(u),f=r(11),h=r(10),p=r(22),g=r(19);t.default={data:function(){return{tableData:[],tableData_user:[],totalList:0,totalList_user:0,listsizes:[8,12,16,20],listsizes_user:[4,8,12,16],listsize:8,listsize_user:4,currentPage:1,currentPage_user:1,start:0,start_user:0,obj:{},orderList:[],LicenseNo:"",dialogVisible:!1,userlist:"",order:null,index:null,BusinessExpireDate:null,create_time:"",ForceExpireDate:null,name:null,loading:"",change_text:g.change_text,userlist_name:""}},created:function(){},mounted:function(){(0,f.exit)(this),this.init()},components:{},computed:(0,d.default)({},(0,h.mapState)(["userinfo","orderlist"])),methods:(0,d.default)({},(0,h.mapActions)(["getOrderList","getUserInfo"]),{init:function(){var e=this;return(0,c.default)(o.default.mark(function t(){return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$store.dispatch("getOrderList");case 3:if(JSON.parse(sessionStorage.userInfo)){t.next=6;break}return t.next=6,e.$store.dispatch("getUserInfo");case 6:e.tableData=e.$store.state.orderlist.slice(e.start,e.start+e.listsize),e.loading=!1,e.totalList=e.$store.state.orderlist.length,e.orderList=e.$store.state.orderlist;case 10:case"end":return t.stop()}},t,e)}))()},handleSelect:function(e,t){return e.length>1?((0,f.layer)("warning","只能分配一单",this),void this.$refs.orderlist.toggleRowSelection(e[1])):void(this.order=e[0])},handleSelectAll:function(e,t){this.$refs.orderlist.clearSelection()},handleSelectAllUser:function(e,t){this.$refs.userOrder.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){this.start=this.listsize*(this.currentPage-1),this.listsize=e,this.tableData=this.orderList.slice(this.start,this.start+e)},handleCurrentChange:function(e){this.start=this.listsize*(e-1),this.currentPage=e,this.tableData=this.orderList.slice(this.start,this.start+this.listsize)},handleSizeChange_user:function(e){this.start_user=this.listsize_user*(this.currentPage_user-1),this.listsize_user=e,this.tableData_user=this.userlist.slice(this.start_user,this.start_user+e)},handleCurrentChange_user:function(e){this.start_user=this.listsize_user*(e-1),this.currentPage_user=e,this.tableData_user=this.userlist.slice(this.start_user,this.start_user+this.listsize_user)},handleClick:function(e){if(e.priceSession.recordId=e._id,e.priceSession.order=e.order,e.priceSession.SubmitGroup=e.SubmitGroup,e.priceSession.UserInfo.ModleName=e.reinfo.ModleName,e.priceSession.UserInfo.LicenseOwner=e.reinfo.LicenseOwner,e.priceSession.UserInfo.LicenseNo=e.reinfo.LicenseNo,sessionStorage.setItem("baojia",(0,n.default)(e.priceSession)),sessionStorage.setItem("SubmitGroup",e.SubmitGroup),e.order&&e.order.Source){var t=e.priceSession.Items.filter(function(t){return t.Source==e.order.Source});if(!t[0])return;t=t[0];var r=(0,f.analyzeTabel)(g.change_text.alltype,t,["chinese","allfei"]),a=(0,f.fliterBaoe)(t);if(sessionStorage.setItem("Source",e.order.Source),sessionStorage.setItem("tableData1",(0,n.default)(r)),sessionStorage.setItem("tableData",(0,n.default)(a)),"3"==e.order.approvalStatus||"2"==e.order.approvalStatus)return void this.$router.push("orderoffer?type=read");if("4"==e.order.approvalStatus)return void this.$router.push("orderoffer?type=edit")}this.$router.push("suboffer?type=order")},handleStatus:function(e,t){this.$msgbox({title:"改变状态",message:"确定将改变"+t+"状态?"})},pickerOptions0:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},search:function(){this.searchorder=this.$store.state.orderlist,this.tableData=(0,f.serachInput)({LicenseNo:this.LicenseNo,salesmanName:{name:"order",value:this.name,type:"text"},create_time:{value:this.create_time,type:"datetimerange"},ForceExpireDate:{name:"reinfo",value:this.ForceExpireDate,type:"datetimerange"},BusinessExpireDate:{name:"reinfo",value:this.BusinessExpireDate,type:"datetimerange"}},this.searchorder),this.orderList=this.tableData,this.totalList=this.tableData.length},searchuser:function(){this.tableData_user=(0,f.serachInput)({name:this.userlist_name},this.olduserlist),this.userlist=this.tableData_user,this.totalList_user=this.tableData_user.length},handdis:function(e,t){return this.$refs.orderlist.clearSelection(),this.$refs.orderlist.toggleRowSelection(e),this.order=e,e.order?void(0,f.layer)("error","该单已分配",this):(this.index=t,void this.distribute())},distribute:function(e){var t=this;return(0,c.default)(o.default.mark(function e(){var r,a,s,n,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,f.inputCheck)([[!t.order,"请先选一单"],[t.order&&t.order.order,"该单已分配"]],t),r!=-1){e.next=3;break}return e.abrupt("return");case 3:if(t.dialogVisible=!0,sessionStorage.userInfo||location.reload(),a=JSON.parse(sessionStorage.userInfo),s={name:a.name,username:a.username,parentId:a.parentId,userId:a.userId},3!=a.level){e.next=12;break}t.tableData_user=[s],t.totalList_user=1,e.next=21;break;case 12:return n={userId:a.userId},e.next=15,(0,p.getsuperior)(n);case 15:i=e.sent,t.userlist=i.res,t.userlist.unshift(s),t.olduserlist=t.userlist,t.totalList_user=t.userlist.length,t.tableData_user=t.userlist.slice(0,4);case 21:case"end":return e.stop()}},e,t)}))()},disUser:function(e,t){var r=this;return(0,c.default)(o.default.mark(function e(){var a,s,i,l,c;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.$store.state.orderlist,s=a.filter(function(e){if(e.order)return e.order.salesmanName==t.name&&3!=e.order.approvalStatus}),e.next=4,r.$store.dispatch("getUserInfo");case 4:if(sessionStorage.userInfo=(0,n.default)(r.$store.state.userinfo),!(s.length>=JSON.parse(sessionStorage.userInfo).orderCount)){e.next=9;break}return(0,f.layer)("error","该业务员单数达到上限",r),r.$refs.userOrder.clearSelection(),e.abrupt("return");case 9:return i={salesmanId:t.userId,salesmanName:t.name,from:JSON.parse(sessionStorage.userInfo).userId,LicenseNo:r.order.LicenseNo,recordId:r.order._id},l=r.$loading({body:!0,text:"加载中...",customClass:"loading"}),e.next=13,(0,p.disOrder)(i);case 13:c=e.sent,l.close(),0==c.code?r.$confirm("分配成功","提示",{showCancelButton:!1}).then(function(){r.tableData[r.index].order=c.res,r.tableData[r.index].order.salesmanName=c.res.salesmanName,r.dialogVisible=!1}).catch(function(){r.tableData[r.index].order=c.res,r.tableData[r.index].order.salesmanName=c.res.salesmanName,r.dialogVisible=!1}):((0,f.layer)("error",c.ch||"分配失败",r),r.$refs.userOrder.clearSelection());case 16:case"end":return e.stop()}},e,r)}))()},delorder:function(e,t){var r=this;return(0,c.default)(o.default.mark(function a(){var s;return o.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(s=(0,f.inputCheck)([[!e.order,"该单未分配"],[e.order&&2==e.order.approvalStatus,"该单正在审核"],[e.order&&3==e.order.approvalStatus,"该单已出单"]],r),s!=-1){a.next=3;break}return a.abrupt("return");case 3:r.$confirm("是否需要释放订单","提示",{}).then(function(){(0,p.delOrder)(e.order.orderId,JSON.parse(sessionStorage.userInfo).userId).then(function(e){0==e.code?((0,f.layer)("success","回收成功",r),r.tableData[t].order=null,r.order=null):(0,f.layer)("error",e.ch||"回收失败",r)})}).catch(function(){r.$refs.orderlist.clearSelection(),r.order=null});case 4:case"end":return a.stop()}},a,r)}))()},del_order:function(){(0,f.layer)("info","该功能尚未开发",this)},priceStatus:function(e){var t="";return e.map(function(e){t+="<span style='color:",t+=e.QuoteStatus>0?"#5CB85C'>报价成功(":"#D43F3A'>报价失败(",t+=g.change_text.suboffer[e.Source].slice(2)+")</span><br/>"}),t},getapprovalStatus:function(e){if(e.order){var t;switch(e.order.approvalStatus){case"1":t="未提交";break;case"2":t="待审核";break;case"3":t="已出单";break;case"4":t="未通过"}return t}return"未分配"}})}},188:function(e,t,r){t=e.exports=r(4)(),t.push([e.id,'.incontent[data-v-3f26232f]{position:absolute;left:0;right:0;bottom:0;top:0;overflow:scroll;padding-top:.3rem;background:#fff;font-size:14px}.incontent div.search[data-v-3f26232f]{width:100%}.incontent div.search .serinput[data-v-3f26232f]{width:1.6rem}.incontent div.search .el-col[data-v-3f26232f]{text-align:right;margin-bottom:.16rem}.incontent div.search .serfoot[data-v-3f26232f]{width:100%;text-align:right;padding-bottom:.1rem;position:relative;top:-.3rem;padding-right:.5rem;border-bottom:1px solid #ccc;float:right}.incontent div.search .serfoot [data-v-3f26232f]:before{content:"";clear:both;width:100%;overflow:hidden;visibility:hidden}.incontent div.search .serfoot .el-button[data-v-3f26232f]{background:#d43f3a;color:#fff;width:1rem}.incontent div.search .serfoot .el-button[data-v-3f26232f]:first-child:hover{border-color:#d43f3a}.incontent div.search .serfoot .el-button[data-v-3f26232f]:nth-child(2){background:#5cb85c}.incontent div.search .serfoot .el-button[data-v-3f26232f]:nth-child(3){background:#428bca}.incontent .handle[data-v-3f26232f]{height:.5rem;line-height:.5rem;text-align:right;padding-right:.3rem}.incontent .handle span[data-v-3f26232f]{margin-right:.26rem;color:#4897d3;cursor:default}.incontent .el-pagination[data-v-3f26232f]{text-align:center;margin-top:.22rem;margin-bottom:.2rem}.incontent .userlist .el-row[data-v-3f26232f]{margin-top:-.2rem}',"",{version:3,sources:["/./src/page/ordermag/orderlist.vue"],names:[],mappings:"AACA,4BAA4B,kBAAkB,OAAO,QAAQ,SAAS,MAAM,gBAAgB,kBAAkB,gBAAgB,cAAc,CAC3I,AACD,uCAAuC,UAAU,CAChD,AACD,iDAAiD,YAAY,CAC5D,AACD,+CAA+C,iBAAiB,oBAAoB,CACnF,AACD,gDAAgD,WAAW,iBAAiB,qBAAqB,kBAAkB,WAAW,oBAAoB,6BAA6B,WAAW,CACzL,AACD,wDAAyD,WAAW,WAAW,WAAW,gBAAgB,iBAAiB,CAC1H,AACD,2DAA2D,mBAAmB,WAAY,UAAU,CACnG,AACD,6EAA8E,oBAAoB,CACjG,AACD,wEAAwE,kBAAkB,CACzF,AACD,wEAAwE,kBAAkB,CACzF,AACD,oCAAoC,aAAa,kBAAkB,iBAAiB,mBAAmB,CACtG,AACD,yCAAyC,oBAAoB,cAAc,cAAc,CACxF,AACD,2CAA2C,kBAAkB,kBAAkB,mBAAmB,CACjG,AACD,8CAA8C,iBAAiB,CAC9D",file:"orderlist.vue",sourcesContent:['\n.incontent[data-v-3f26232f]{position:absolute;left:0;right:0;bottom:0;top:0;overflow:scroll;padding-top:.3rem;background:#fff;font-size:14px\n}\n.incontent div.search[data-v-3f26232f]{width:100%\n}\n.incontent div.search .serinput[data-v-3f26232f]{width:1.6rem\n}\n.incontent div.search .el-col[data-v-3f26232f]{text-align:right;margin-bottom:.16rem\n}\n.incontent div.search .serfoot[data-v-3f26232f]{width:100%;text-align:right;padding-bottom:.1rem;position:relative;top:-.3rem;padding-right:.5rem;border-bottom:1px solid #ccc;float:right\n}\n.incontent div.search .serfoot [data-v-3f26232f]::before{content:"";clear:both;width:100%;overflow:hidden;visibility:hidden\n}\n.incontent div.search .serfoot .el-button[data-v-3f26232f]{background:#d43f3a;color:white;width:1rem\n}\n.incontent div.search .serfoot .el-button[data-v-3f26232f]:nth-child(1):hover{border-color:#d43f3a\n}\n.incontent div.search .serfoot .el-button[data-v-3f26232f]:nth-child(2){background:#5CB85C\n}\n.incontent div.search .serfoot .el-button[data-v-3f26232f]:nth-child(3){background:#428BCA\n}\n.incontent .handle[data-v-3f26232f]{height:.5rem;line-height:.5rem;text-align:right;padding-right:.3rem\n}\n.incontent .handle span[data-v-3f26232f]{margin-right:.26rem;color:#4897D3;cursor:default\n}\n.incontent .el-pagination[data-v-3f26232f]{text-align:center;margin-top:.22rem;margin-bottom:.2rem\n}\n.incontent .userlist .el-row[data-v-3f26232f]{margin-top:-.2rem\n}\n'],sourceRoot:"webpack://"}])},204:function(e,t,r){var a=r(188);"string"==typeof a&&(a=[[e.id,a,""]]);r(5)(a,{});a.locals&&(e.exports=a.locals)},226:function(e,t,r){r(204);var a=r(3)(r(117),r(244),"data-v-3f26232f",null);e.exports=a.exports},244:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"incontent orderlist"},[r("div",{staticClass:"search"},[r("el-row",[r("el-col",{attrs:{span:6}},[r("div",{staticClass:"grid-content bg-purple"},[r("span",[e._v("车牌号：")]),r("el-input",{staticClass:"serinput",on:{change:e.search},model:{value:e.LicenseNo,callback:function(t){e.LicenseNo=t},expression:"LicenseNo"}})],1)]),e._v(" "),r("el-col",{attrs:{span:7}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("span",[e._v("录入时间：")]),e._v(" "),r("el-date-picker",{attrs:{type:"daterange",placeholder:"选择时间范围",format:"yyyy-MM-dd","picker-options":e.pickerOptions0},on:{change:e.search},model:{value:e.create_time,callback:function(t){e.create_time=t},expression:"create_time"}})],1)]),e._v(" "),r("el-col",{attrs:{span:7}},[r("div",{staticClass:"grid-content bg-purple"},[r("span",[e._v("业务员：")]),r("el-input",{staticClass:"serinput",on:{change:e.search},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:6}},[r("div",{staticClass:"grid-content bg-purple"},[r("span",[e._v("交强险到期时间：")]),e._v(" "),r("el-date-picker",{attrs:{type:"daterange",placeholder:"选择日期范围",format:"yyyy-MM-dd","picker-options":e.pickerOptions0},on:{change:e.search},model:{value:e.ForceExpireDate,callback:function(t){e.ForceExpireDate=t},expression:"ForceExpireDate"}})],1)]),e._v(" "),r("el-col",{attrs:{span:7}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("span",[e._v("商业险到期时间：")]),e._v(" "),r("el-date-picker",{attrs:{type:"daterange",placeholder:"选择日期范围",format:"yyyy-MM-dd","picker-options":e.pickerOptions0},on:{change:e.search},model:{value:e.BusinessExpireDate,callback:function(t){e.BusinessExpireDate=t},expression:"BusinessExpireDate"}})],1)])],1),e._v(" "),r("el-dialog",{attrs:{visible:e.dialogVisible,title:"选择业务员"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("div",{staticClass:"userlist"},[r("el-row",[r("el-col",{attrs:{span:7}},[r("el-input",{attrs:{placeholder:"输入业务员姓名"},on:{change:e.searchuser},model:{value:e.userlist_name,callback:function(t){e.userlist_name=t},expression:"userlist_name"}})],1),e._v(" "),r("el-col",{attrs:{span:8}},[r("el-button",{on:{click:e.searchuser}},[e._v("搜索")])],1)],1),e._v(" "),r("el-table",{ref:"userOrder",staticStyle:{width:"100%"},attrs:{data:e.tableData_user,border:""},on:{select:e.disUser,"select-all":e.handleSelectAllUser}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"业务员姓名"}}),e._v(" "),r("el-table-column",{attrs:{prop:"username",label:"业务员账号"}})],1),e._v(" "),r("el-pagination",{attrs:{"current-page":e.currentPage_user,"page-sizes":e.listsizes_user,"page-size":e.listsize_user,layout:"total, sizes, prev, pager, next, jumper",total:e.totalList_user},on:{"size-change":e.handleSizeChange_user,"current-change":e.handleCurrentChange_user}})],1)]),e._v(" "),r("div",{staticClass:"serfoot"},[r("el-button",{on:{click:e.search}},[e._v("搜索")]),e._v(" "),r("el-button",{on:{click:e.distribute}},[e._v("分配")])],1)],1),e._v(" "),e._m(0),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"orderlist",staticStyle:{width:"96%","margin-left":"2%"},attrs:{data:e.tableData,border:""},on:{select:e.handleSelect,"select-all":e.handleSelectAll,"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),r("el-table-column",{attrs:{prop:"reinfo.LicenseOwner","show-overflow-tooltip":"",label:"车主"}}),e._v(" "),r("el-table-column",{attrs:{prop:"reinfo.LicenseNo",width:"115",label:"车牌号"}}),e._v(" "),r("el-table-column",{attrs:{width:"135",prop:"reinfo.ForceExpireDate",label:"交强险到期时间"}}),e._v(" "),r("el-table-column",{attrs:{width:"135",prop:"reinfo.BusinessExpireDate",label:"商业险到期时间"}}),e._v(" "),r("el-table-column",{attrs:{width:"120","show-overflow-tooltip":"",label:"录入时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row&&new Date(t.row.create_time).toLocaleDateString())+"\n        ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.getapprovalStatus(t.row))+"         \n        ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"报价状态",width:"145"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{domProps:{innerHTML:e._s(e.priceStatus(t.row.priceSession.Items))}})]}}])}),e._v(" "),r("el-table-column",{attrs:{width:"85","show-overflow-tooltip":"",label:"业务员"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.order?t.row.order.salesmanName:"N/A")+"\n        ")]}}])}),e._v(" "),r("el-table-column",{attrs:{width:"76",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.handdis(t.row,t.$index)}}},[e._v("分配")]),r("br"),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.delorder(t.row,t.$index)}}},[e._v("回收")])]}}])}),e._v(" "),r("el-table-column",{attrs:{width:"80",label:"详情"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.handleClick(t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),r("div",[r("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":e.listsizes,"page-size":e.listsize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalList},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"handle"},[r("span",[r("i",{staticClass:"el-icon-delete"}),e._v("批量删除")]),r("span",[r("i",{staticClass:"el-icon-upload2"}),e._v("导出Excel")])])}]}}});